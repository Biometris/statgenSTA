<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot function for class STA — plot.STA • statgenSTA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot function for class STA — plot.STA"><meta name="description" content="This function draws either four base plots:
A histogram of the residuals
A normal Q-Q plot
A residuals vs fitted values plot
An absolute residuals vs fitted values plot
or five or six spatial plots:
A spatial plot of the raw data
A spatial plot of the fitted data
A spatial plot of the residuals
A spatial plot of the estimated spatial trend (SpATS only)
A spatial plot of the BLUEs or BLUPs
A histogram of the BLUEs or BLUPs
Spatial plots can only be made if the data contains both row and column
information."><meta property="og:description" content="This function draws either four base plots:
A histogram of the residuals
A normal Q-Q plot
A residuals vs fitted values plot
An absolute residuals vs fitted values plot
or five or six spatial plots:
A spatial plot of the raw data
A spatial plot of the fitted data
A spatial plot of the residuals
A spatial plot of the estimated spatial trend (SpATS only)
A spatial plot of the BLUEs or BLUPs
A histogram of the BLUEs or BLUPs
Spatial plots can only be made if the data contains both row and column
information."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">statgenSTA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-seedling"></span> other packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenHTP">statgenHTP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/statgenSTA"><span class="fa fa-github fa-lg fab"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot function for class STA</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenSTA/blob/main/R/createSTA.R" class="external-link"><code>R/createSTA.R</code></a></small>
      <div class="d-none name"><code>plot.STA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function draws either four base plots:</p><ul><li><p>A histogram of the residuals</p></li>
<li><p>A normal Q-Q plot</p></li>
<li><p>A residuals vs fitted values plot</p></li>
<li><p>An absolute residuals vs fitted values plot</p></li>
</ul><p>or five or six spatial plots:</p><ul><li><p>A spatial plot of the raw data</p></li>
<li><p>A spatial plot of the fitted data</p></li>
<li><p>A spatial plot of the residuals</p></li>
<li><p>A spatial plot of the estimated spatial trend (SpATS only)</p></li>
<li><p>A spatial plot of the BLUEs or BLUPs</p></li>
<li><p>A histogram of the BLUEs or BLUPs</p></li>
</ul><p>Spatial plots can only be made if the data contains both row and column
information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'STA'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  trials <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  traits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  what <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"base"</span>, <span class="st">"spatial"</span><span class="op">)</span>,</span>
<span>  spaTrend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"raw"</span>, <span class="st">"percentage"</span><span class="op">)</span>,</span>
<span>  outCols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">plotType</span> <span class="op">==</span> <span class="st">"base"</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class STA.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further graphical parameters.</p></dd>


<dt id="arg-trials">trials<a class="anchor" aria-label="anchor" href="#arg-trials"></a></dt>
<dd><p>A character vector indicating the trials to plot. If
<code>trials = NULL</code>, all trials are plotted.</p></dd>


<dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>A character vector indicating the traits to plot. If
<code>traits = NULL</code>, all traits are plotted.</p></dd>


<dt id="arg-what">what<a class="anchor" aria-label="anchor" href="#arg-what"></a></dt>
<dd><p>A character string indicating whether the fitted model with
genotype as fixed (<code>what = "fixed"</code>) or genotype as random
(<code>what = "random"</code>) factor should be plotted.
If <code>x</code> contains only one model this model is chosen automatically.</p></dd>


<dt id="arg-plottype">plotType<a class="anchor" aria-label="anchor" href="#arg-plottype"></a></dt>
<dd><p>A character string indicating whether <code>base</code> plots or
<code>spatial</code> plots should be made.</p></dd>


<dt id="arg-spatrend">spaTrend<a class="anchor" aria-label="anchor" href="#arg-spatrend"></a></dt>
<dd><p>A character string indicating how the spatial trend should
be displayed. Either "raw" (original scale), or "percentage". If
"percentage", the estimated spatial trend is scaled (i.e., divided by the
average of the observed response variable of interest across the field) and
results are shown as a percentage.</p></dd>


<dt id="arg-outcols">outCols<a class="anchor" aria-label="anchor" href="#arg-outcols"></a></dt>
<dd><p>An integer indicating the number of columns to use for
displaying the plots. Usually the default of 2 for base plots and 3 for
spatial plots will be fine, but decreasing the numbers may help for nicer
printing.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>A character string used a title for the plot. Note that when
a title is specified and multiple plots are created, all plots will get the
same title.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>Should the plot be output to the current device? If
<code>FALSE</code> only a list of ggplot objects is invisibly returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing ggplot objects for the selected plots.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions for STA objects:
<code><a href="STAtoCross.html">STAtoCross</a>()</code>,
<code><a href="STAtoTD.html">STAtoTD</a>()</code>,
<code><a href="report.STA.html">report.STA</a>()</code>,
<code><a href="summary.STA.html">summary.STA</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Run a single trait analysis using SpATS.</span></span></span>
<span class="r-in"><span><span class="va">modSp</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitTD.html">fitTD</a></span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDHeat05</span>,</span></span>
<span class="r-in"><span>               design <span class="op">=</span> <span class="st">"res.rowcol"</span>,</span></span>
<span class="r-in"><span>               traits <span class="op">=</span> <span class="st">"yield"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using SpATS for fitting models.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create base plots.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modSp</span>,</span></span>
<span class="r-in"><span>     what <span class="op">=</span> <span class="st">"fixed"</span>,</span></span>
<span class="r-in"><span>     plotType <span class="op">=</span> <span class="st">"base"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.STA-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create spatial plots.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modSp</span>,</span></span>
<span class="r-in"><span>     what <span class="op">=</span> <span class="st">"fixed"</span>,</span></span>
<span class="r-in"><span>     plotType <span class="op">=</span> <span class="st">"spatial"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.STA-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create spatial plots showing the spatial trend as percentage.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">modSp</span>,</span></span>
<span class="r-in"><span>     what <span class="op">=</span> <span class="st">"fixed"</span>,</span></span>
<span class="r-in"><span>     plotType <span class="op">=</span> <span class="st">"spatial"</span>,</span></span>
<span class="r-in"><span>     spaTrend <span class="op">=</span> <span class="st">"percentage"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.STA-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

