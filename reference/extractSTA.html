<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Extract and calculate various results for fitted models such as BLUEs, BLUPs,
unit errors and heritabilities. For a full list of results that can be
extracted, see the table below.
The result(s) to extract can be specified in what.
If a single result is extracted, this result is returned as a
data.frame, If this is not possible, because the format of the result
is incompatible with the data.frame format, the result is returned as
a list. E.g. if BLUEs are extracted, the output of the function is a
data.frame with BLUEs. However if varCompF is extracted, the
output of the function is a list.
Results that are returned as data.frame are marked as such in the
asDataFrame column in the table. If the default return value for a result
is a data.frame that can be overridden by the user by specifying
asDataFrame = FALSE. When doing so the result will be returned as a
list of data.frames, one per trial. They other way round is not possible.
If a result is returned as a list according to the table, it cannot
be returned as a data.frame.
If multiple results are extracted at the same time, these are always
returned as a list.

Most results can only be calculated if a model is fitted with genotype as
fixed or with genotype as random. E.g. to compute heritabilities a model
should be fitted with genotype as random effect. This is indicated in the
table in the column model with "F" and "R" respectively.
Possible options for what are:
resultmodeldescriptionasDataFrame
BLUEsFBest Linear Unbiased Estimatorsyes
seBLUEsFstandard errors of the BLUEsyes
ueFunit errors - only for lme4 and asremlyes
varCompFFvariance components for the model with genotype as fixed component
fittedFfitted values for the model with genotype as fixed componentyes
residFFresiduals for the model with genotype as fixed componentyes
stdResFFstandardized residuals for the model with genotype as fixed componentyes
waldFresults of the wald test - only for lme4 and asreml
CVRCoefficient of Variationyes
rDfFFresidual degrees of freedom for the model with genotype as fixed componentyes
sedFstandard error of difference - only for asreml
lsdFleast significant difference - only for asreml
BLUPsRBest Linear Unbiased Predictorsyes
seBLUPsRstandard errors of the BLUPsyes
heritabilityRbroad sense heritabilityyes
varCompRRvariance components for the model with genotype as random component
varGenRgenetic variance componentyes
varErrRresidual variance componentyes
varSpatRspatial variance components - only for SpATS
rMeansRfitted values for the model with genotype as random componentyes
ranEfRrandom genetic effectsyes
residRRresiduals for the model with genotype as random componentyes
stdResRRstandardized residuals for the model with genotype as random componentyes
rDfRRresidual degrees of freedom for the model with genotype as random componentyes
effDimReffective dimensions - only for SpATS
ratEffDimRratios of the effective dimensions - only for SpATS


'><title>Extract statistics from fitted models — extractSTA • statgenSTA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract statistics from fitted models — extractSTA"><meta property="og:description" content='Extract and calculate various results for fitted models such as BLUEs, BLUPs,
unit errors and heritabilities. For a full list of results that can be
extracted, see the table below.
The result(s) to extract can be specified in what.
If a single result is extracted, this result is returned as a
data.frame, If this is not possible, because the format of the result
is incompatible with the data.frame format, the result is returned as
a list. E.g. if BLUEs are extracted, the output of the function is a
data.frame with BLUEs. However if varCompF is extracted, the
output of the function is a list.
Results that are returned as data.frame are marked as such in the
asDataFrame column in the table. If the default return value for a result
is a data.frame that can be overridden by the user by specifying
asDataFrame = FALSE. When doing so the result will be returned as a
list of data.frames, one per trial. They other way round is not possible.
If a result is returned as a list according to the table, it cannot
be returned as a data.frame.
If multiple results are extracted at the same time, these are always
returned as a list.

Most results can only be calculated if a model is fitted with genotype as
fixed or with genotype as random. E.g. to compute heritabilities a model
should be fitted with genotype as random effect. This is indicated in the
table in the column model with "F" and "R" respectively.
Possible options for what are:
resultmodeldescriptionasDataFrame
BLUEsFBest Linear Unbiased Estimatorsyes
seBLUEsFstandard errors of the BLUEsyes
ueFunit errors - only for lme4 and asremlyes
varCompFFvariance components for the model with genotype as fixed component
fittedFfitted values for the model with genotype as fixed componentyes
residFFresiduals for the model with genotype as fixed componentyes
stdResFFstandardized residuals for the model with genotype as fixed componentyes
waldFresults of the wald test - only for lme4 and asreml
CVRCoefficient of Variationyes
rDfFFresidual degrees of freedom for the model with genotype as fixed componentyes
sedFstandard error of difference - only for asreml
lsdFleast significant difference - only for asreml
BLUPsRBest Linear Unbiased Predictorsyes
seBLUPsRstandard errors of the BLUPsyes
heritabilityRbroad sense heritabilityyes
varCompRRvariance components for the model with genotype as random component
varGenRgenetic variance componentyes
varErrRresidual variance componentyes
varSpatRspatial variance components - only for SpATS
rMeansRfitted values for the model with genotype as random componentyes
ranEfRrandom genetic effectsyes
residRRresiduals for the model with genotype as random componentyes
stdResRRstandardized residuals for the model with genotype as random componentyes
rDfRRresidual degrees of freedom for the model with genotype as random componentyes
effDimReffective dimensions - only for SpATS
ratEffDimRratios of the effective dimensions - only for SpATS


'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">statgenSTA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.12</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--other-packages">
    <span class="fa fa-seedling"></span>
     
    other packages
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--other-packages">
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenHTP">statgenHTP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a>
    <a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Biometris/statgenSTA">
    <span class="fa fa-github fa-lg fab"></span>
     
    github
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Extract statistics from fitted models</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenSTA/blob/HEAD/R/extractSTA.R" class="external-link"><code>R/extractSTA.R</code></a></small>
      <div class="d-none name"><code>extractSTA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract and calculate various results for fitted models such as BLUEs, BLUPs,
unit errors and heritabilities. For a full list of results that can be
extracted, see the table below.<br><br>
The result(s) to extract can be specified in <code>what</code>.<br>
If a single result is extracted, this result is returned as a
<code>data.frame</code>, If this is not possible, because the format of the result
is incompatible with the <code>data.frame</code> format, the result is returned as
a list. E.g. if BLUEs are extracted, the output of the function is a
<code>data.frame</code> with BLUEs. However if varCompF is extracted, the
output of the function is a <code>list</code>.<br><br>
Results that are returned as <code>data.frame</code> are marked as such in the
asDataFrame column in the table. If the default return value for a result
is a <code>data.frame</code> that can be overridden by the user by specifying
<code>asDataFrame = FALSE</code>. When doing so the result will be returned as a
list of data.frames, one per trial. They other way round is not possible.
If a result is returned as a <code>list</code> according to the table, it cannot
be returned as a <code>data.frame</code>.<br>
If multiple results are extracted at the same time, these are always
returned as a list.
<br><br>
Most results can only be calculated if a model is fitted with genotype as
fixed or with genotype as random. E.g. to compute heritabilities a model
should be fitted with genotype as random effect. This is indicated in the
table in the column model with "F" and "R" respectively.</p>
<p>Possible options for <code>what</code> are:</p><table class="table table"><tr><td>result</td><td>model</td><td>description</td><td>asDataFrame</td></tr><tr><td>BLUEs</td><td>F</td><td>Best Linear Unbiased Estimators</td><td>yes</td></tr><tr><td>seBLUEs</td><td>F</td><td>standard errors of the BLUEs</td><td>yes</td></tr><tr><td>ue</td><td>F</td><td>unit errors - only for lme4 and asreml</td><td>yes</td></tr><tr><td>varCompF</td><td>F</td><td>variance components for the model with genotype as fixed component</td><td></td></tr><tr><td>fitted</td><td>F</td><td>fitted values for the model with genotype as fixed component</td><td>yes</td></tr><tr><td>residF</td><td>F</td><td>residuals for the model with genotype as fixed component</td><td>yes</td></tr><tr><td>stdResF</td><td>F</td><td>standardized residuals for the model with genotype as fixed component</td><td>yes</td></tr><tr><td>wald</td><td>F</td><td>results of the wald test - only for lme4 and asreml</td><td></td></tr><tr><td>CV</td><td>R</td><td>Coefficient of Variation</td><td>yes</td></tr><tr><td>rDfF</td><td>F</td><td>residual degrees of freedom for the model with genotype as fixed component</td><td>yes</td></tr><tr><td>sed</td><td>F</td><td>standard error of difference - only for asreml</td><td></td></tr><tr><td>lsd</td><td>F</td><td>least significant difference - only for asreml</td><td></td></tr><tr><td>BLUPs</td><td>R</td><td>Best Linear Unbiased Predictors</td><td>yes</td></tr><tr><td>seBLUPs</td><td>R</td><td>standard errors of the BLUPs</td><td>yes</td></tr><tr><td>heritability</td><td>R</td><td>broad sense heritability</td><td>yes</td></tr><tr><td>varCompR</td><td>R</td><td>variance components for the model with genotype as random component</td><td></td></tr><tr><td>varGen</td><td>R</td><td>genetic variance component</td><td>yes</td></tr><tr><td>varErr</td><td>R</td><td>residual variance component</td><td>yes</td></tr><tr><td>varSpat</td><td>R</td><td>spatial variance components - only for SpATS</td><td></td></tr><tr><td>rMeans</td><td>R</td><td>fitted values for the model with genotype as random component</td><td>yes</td></tr><tr><td>ranEf</td><td>R</td><td>random genetic effects</td><td>yes</td></tr><tr><td>residR</td><td>R</td><td>residuals for the model with genotype as random component</td><td>yes</td></tr><tr><td>stdResR</td><td>R</td><td>standardized residuals for the model with genotype as random component</td><td>yes</td></tr><tr><td>rDfR</td><td>R</td><td>residual degrees of freedom for the model with genotype as random component</td><td>yes</td></tr><tr><td>effDim</td><td>R</td><td>effective dimensions - only for SpATS</td><td></td></tr><tr><td>ratEffDim</td><td>R</td><td>ratios of the effective dimensions - only for SpATS</td><td></td></tr></table></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extractSTA</span><span class="op">(</span></span>
<span>  <span class="va">STA</span>,</span>
<span>  trials <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">STA</span><span class="op">)</span>,</span>
<span>  traits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  what <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  asDataFrame <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">what</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;&amp;</span> <span class="va">what</span> <span class="op">!=</span> <span class="st">"all"</span>,</span>
<span>  keep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  restoreColNames <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>STA</dt>
<dd><p>An object of class STA.</p></dd>


<dt>trials</dt>
<dd><p>A character vector of trials for which the statistics should be
computed. If not supplied, statistics are computed for all trials that have
been modeled.</p></dd>


<dt>traits</dt>
<dd><p>A character vector of traits for which the statistics should be
computed. If not supplied, statistics are computed for all traits that have
been modeled.</p></dd>


<dt>what</dt>
<dd><p>A character vector indicating which statistics should be
computed. Most statistics are available for all models, some only for models
fitted using a certain engine. If this is the case, this is indicated in the
list with options in details.<br>
If <code>what = "all"</code>, all available statistics are computed.</p></dd>


<dt>asDataFrame</dt>
<dd><p>Should the output be reshaped to a data.frame. This is
only possible if the number of statistics to extract is one.</p></dd>


<dt>keep</dt>
<dd><p>A character vector of column(s) in the object of class
<code><a href="TD.html">TD</a></code> used for modeling. These columns will be kept as output when
computing fitted values, residuals, standardized residuals and rMeans.
Columns can also be kept when computing (se)BLUEs and (se)BLUPs but only if
the column to keep contains unique values for the modeled variables, i.e. a
column repId with several different values per genotype cannot be kept.</p></dd>


<dt>restoreColNames</dt>
<dd><p>Should the original column names be restored in the
output of the extracted data?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Depending on the input either a data.frame or a list with, per
trial for which statistics have been extracted, a list of those statistics.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="fitTD.html">fitTD</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Fit model using SpATS.</span></span></span>
<span class="r-in"><span><span class="va">modSp</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitTD.html">fitTD</a></span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDHeat05</span>,</span></span>
<span class="r-in"><span>               design <span class="op">=</span> <span class="st">"res.rowcol"</span>,</span></span>
<span class="r-in"><span>               traits <span class="op">=</span> <span class="st">"yield"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using SpATS for fitting models.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract all available statistics from the fitted model.</span></span></span>
<span class="r-in"><span><span class="va">extr</span> <span class="op">&lt;-</span> <span class="fu">extractSTA</span><span class="op">(</span><span class="va">modSp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract only the BLUEs from the fitted model.</span></span></span>
<span class="r-in"><span><span class="va">BLUEs</span> <span class="op">&lt;-</span> <span class="fu">extractSTA</span><span class="op">(</span><span class="va">modSp</span>,</span></span>
<span class="r-in"><span>                    what <span class="op">=</span> <span class="st">"BLUEs"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Extract only the BLUEs from the fitted model and keep trial as variable in</span></span></span>
<span class="r-in"><span><span class="co">## the output.</span></span></span>
<span class="r-in"><span><span class="va">BLUEs2</span> <span class="op">&lt;-</span> <span class="fu">extractSTA</span><span class="op">(</span><span class="va">modSp</span>,</span></span>
<span class="r-in"><span>                     what <span class="op">=</span> <span class="st">"BLUEs"</span>,</span></span>
<span class="r-in"><span>                     keep <span class="op">=</span> <span class="st">"trial"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

