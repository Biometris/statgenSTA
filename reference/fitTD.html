<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit single trial mixed model — fitTD • statgenSTA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit single trial mixed model — fitTD"><meta name="description" content="Perform REML analysis given a specific experimental design using either
SpATS, lme4 or asreml. SpATS is used as a default method when row
coordinates (rowCoord) and column coordinates (colCoord) are present, lme4
otherwise.
See details for the exact models fitted."><meta property="og:description" content="Perform REML analysis given a specific experimental design using either
SpATS, lme4 or asreml. SpATS is used as a default method when row
coordinates (rowCoord) and column coordinates (colCoord) are present, lme4
otherwise.
See details for the exact models fitted."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">statgenSTA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> news</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-seedling"></span> other packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGxE">statgenGxE</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenGWAS">statgenGWAS</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenQTLxT">statgenQTLxT</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenHTP">statgenHTP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenIBD">statgenIBD</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/statgenMPP">statgenMPP</a></li>
    <li><a class="external-link dropdown-item" href="https://biometris.github.io/LMMsolver">LMMsolver</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Biometris/statgenSTA"><span class="fa fa-github fa-lg fab"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit single trial mixed model</h1>
      <small class="dont-index">Source: <a href="https://github.com/Biometris/statgenSTA/blob/main/R/fitTD.R" class="external-link"><code>R/fitTD.R</code></a></small>
      <div class="d-none name"><code>fitTD.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform REML analysis given a specific experimental design using either
SpATS, lme4 or asreml. SpATS is used as a default method when row
coordinates (rowCoord) and column coordinates (colCoord) are present, lme4
otherwise.
See details for the exact models fitted.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitTD</span><span class="op">(</span></span>
<span>  <span class="va">TD</span>,</span>
<span>  trials <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TD</span><span class="op">)</span>,</span>
<span>  design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">traits</span>,</span>
<span>  what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fixed"</span>, <span class="st">"random"</span><span class="op">)</span>,</span>
<span>  covariates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useCheckId <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  spatial <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  engine <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-td">TD<a class="anchor" aria-label="anchor" href="#arg-td"></a></dt>
<dd><p>An object of class <code><a href="TD.html">TD</a></code>.</p></dd>


<dt id="arg-trials">trials<a class="anchor" aria-label="anchor" href="#arg-trials"></a></dt>
<dd><p>A character vector specifying the trials for which the models
should be fitted.</p></dd>


<dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>A character string specifying the experimental design. Either
"ibd" (incomplete block design), "res.ibd" (resolvable incomplete block
design), "rcbd" (randomized complete block design), "rowcol" (row column
design) or "res.rowcol" (resolvable row column design). Can be ignored when
the trial design is specified in the meta data (see <code><a href="getMeta.html">setMeta</a></code>).</p></dd>


<dt id="arg-traits">traits<a class="anchor" aria-label="anchor" href="#arg-traits"></a></dt>
<dd><p>A character vector specifying the traits for which the models
should be fitted.</p></dd>


<dt id="arg-what">what<a class="anchor" aria-label="anchor" href="#arg-what"></a></dt>
<dd><p>A character vector specifying whether "genotype" should
be fitted as fixed or random effect. If not specified, both models are
fitted.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>A character vector specifying covariates to be fitted as
extra fixed effects in the model.</p></dd>


<dt id="arg-usecheckid">useCheckId<a class="anchor" aria-label="anchor" href="#arg-usecheckid"></a></dt>
<dd><p>Should checkId be used as a fixed effect in the model?<br>
If <code>TRUE</code>, <code>TD</code> has to contain a column 'checkId'. Using checkId
as fixed effect can only be done when genotype is fitted as a random effect
in the model.</p></dd>


<dt id="arg-spatial">spatial<a class="anchor" aria-label="anchor" href="#arg-spatial"></a></dt>
<dd><p>Should spatial models be tried? Spatial models can
only be fitted with SpATS and asreml. If SpATS is used for modeling, only
spatial models can be fitted and spatial is always set to <code>TRUE</code>. If
asreml is used, fitting spatial models is optional.</p></dd>


<dt id="arg-engine">engine<a class="anchor" aria-label="anchor" href="#arg-engine"></a></dt>
<dd><p>A character string specifying the name of the mixed modeling
engine to use, either "SpATS", "lme4" or "asreml." For spatial models,
"SpaTS" is used as default, for other models "lme4".</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>An optional list with control parameters to be passed to the
actual fitting functions. Currently <code>nSeg</code> and <code>nestDiv</code> are valid
parameters when fitting a model using SpATS. They pass a value to nseg and
nest.div in <code><a href="https://rdrr.io/pkg/SpATS/man/PSANOVA.html" class="external-link">PSANOVA</a></code> respectively. For <code>nSeg</code> also a
named list can be supplied containing values for nSeg per trial.<br><code>criterion</code> is a valid parameter when fitting a spatial model using
asreml. It may be used to pass a goodness-of-fit criterion for comparing
different spatial models. See also in details. Other parameters are ignored.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Should the progress of the modeling be printed. If
<code>TRUE</code>, for every trial a line is output indicating the traits fitted
for the particular trial.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to <code>SpATS</code>, <code>lme4</code> or
<code>asreml</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>STA</code>, a list containing, per trial
that has been analyzed, a list of:</p>
<dl><dt>mRand</dt>
<dd><p>A list of models with fitted with genotype as random effect.</p></dd>

<dt>mFix</dt>
<dd><p>A list of models fitted with genotype as fixed effect.</p></dd>

<dt>TD</dt>
<dd><p>An object of class <code><a href="TD.html">TD</a></code> containing the data on which
<code>mRand</code> and <code>mFix</code> are based.</p></dd>

<dt>traits</dt>
<dd><p>A character vector indicating the traits for which the models
are fitted.</p></dd>

<dt>design</dt>
<dd><p>A character string containing the design of the trial.
(see <code>fitTD</code> for the possible designs).</p></dd>

<dt>spatial</dt>
<dd><p>A character string indicating the spatial part of the model.
<code>FALSE</code> if no spatial design has been used.</p></dd>

<dt>engine</dt>
<dd><p>A character string containing the engine used for the
analysis.</p></dd>

<dt>predicted</dt>
<dd><p>A character string indicating the variable that has been
predicted.</p></dd>

<dt>sumTab</dt>
<dd><p>A data.frame with a summary table for the spatial models tried
when <code>engine = "asreml"</code> and <code>spatial = TRUE</code></p></dd>

<dt>useCheckId</dt>
<dd><p>A boolean indicating if checkId was used when fitting the
models</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The actual model fitted depends on the design. For the supported designs, the
following models are used:</p><table class="table table"><tr><td>Design</td><td>Code</td><td>Model fitted</td></tr><tr><td>incomplete block design</td><td>ibd</td><td>trait = <strong>subBlock</strong> + genotype + \(\epsilon\)</td></tr><tr><td>resolvable incomplete block design</td><td>res.ibd</td><td>trait = <em>repId</em> + <strong>repId:subBlock</strong> + genotype + \(\epsilon\)</td></tr><tr><td>randomized complete block design</td><td>rcbd</td><td>trait = <em>repId</em> + genotype + \(\epsilon\)</td></tr><tr><td>row column design</td><td>rowcol</td><td>trait = <strong>rowId</strong> + <strong>colId</strong> + genotype + \(\epsilon\)</td></tr><tr><td>resolvable row column design</td><td>res.rowcol</td><td>trait = <em>repId</em> + <strong>repId:rowId</strong> + <strong>repId:colId</strong> + genotype + \(\epsilon\)</td></tr></table><p>In the models above, fixed effects are indicated in <em>italics</em> whereas random
effects are indicated in <strong>bold</strong>. genotype can be fitted as fixed or as
random effect depending on the value of the parameter <code>what</code>. Extra
fixed effects may be fitted using the parameter <code>covariates</code>.<br><br>
If <code>SpATS</code> is used as modeling engine, an extra spatial term is always
included  in the model. This term is constructed using the function
<code><a href="https://rdrr.io/pkg/SpATS/man/PSANOVA.html" class="external-link">PSANOVA</a></code> from the SpATS package as<br><code>PSANOVA(colCoord, rowCoord, nseg = nSeg, nest.div = 2)</code>
where<br><code>nSeg = (number of columns / 2, number of rows / 2)</code>. nseg and
nest.div can be modified using the <code>control</code> parameter.<br><br>
When <code>asreml</code> is used for modeling and <code>spatial</code> is <code>TRUE</code>
seven models are fitted with different random terms and covariance structure.
The best model is determined based on a goodness-of-fit criterion, either
AIC or BIC. This can be set using the control parameter <code>criterion</code>,
default is AIC.
The fitted random terms depend on the structure of the data. If the trial
has a regular structure, i.e. all replicates appear the same amount of times
in the trial, the following combinations of random and spatial terms are
fitted:</p><table class="table table"><tr><td>Random part</td><td>Spatial part</td></tr><tr><td>random effects based on design</td><td>none</td></tr><tr><td>random effects based on design</td><td>AR1(rowId):colId</td></tr><tr><td>random effects based on design</td><td>rowId:AR1(colId)</td></tr><tr><td>random effects based on design</td><td>AR1(rowId):ar1(colId)</td></tr><tr><td>random effects based on design + nugget</td><td>AR1(rowId):colId</td></tr><tr><td>random effects based on design + nugget</td><td>rowId:AR1(colId)</td></tr><tr><td>random effects based on design + nugget</td><td>AR1(rowId):AR1(colId)</td></tr></table><p>If the design is not regular the following combinations of random and spatial
terms are fitted:</p><table class="table table"><tr><td>Random part</td><td>Spatial part</td></tr><tr><td>random effects based on design</td><td>none</td></tr><tr><td>random effects based on design</td><td>exp(rowCoord):colCoord</td></tr><tr><td>random effects based on design</td><td>rowCoord:exp(colCoord)</td></tr><tr><td>random effects based on design</td><td>iexp(rowCoord, colCoord)</td></tr><tr><td>random effects based on design  + nugget</td><td>exp(rowCoord):colCoord</td></tr><tr><td>random effects based on design + nugget</td><td>rowCoord:exp(colCoord)</td></tr><tr><td>random effects based on design + nugget</td><td>iexp(rowCoord,colCoord)</td></tr></table></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Maria Xose Rodriguez-Alvarez, Martin P. Boer, Fred A. van Eeuwijk, Paul H.C.
Eilers (2017). Correcting for spatial heterogeneity in plant breeding
experiments with P-splines. Spatial Statistics
<a href="https://doi.org/10.1016/j.spasta.2017.10.003" class="external-link">doi:10.1016/j.spasta.2017.10.003</a></p>
<p>Butler, D. G., et al. (2010). Analysis of Mixed Models for S language
environments: ASReml-R reference manual. Brisbane, DPI Publications</p>
<p>Douglas Bates, Martin Maechler, Ben Bolker, Steve Walker (2015). Fitting
Linear Mixed-Effects Models Using lme4. Journal of Statistical Software,
67(1), 1-48. <a href="https://www.jstatsoft.org/article/view/v067i01/0" class="external-link">https://www.jstatsoft.org/article/view/v067i01/0</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Fit model using lme4.</span></span></span>
<span class="r-in"><span><span class="va">lmeMod</span> <span class="op">&lt;-</span> <span class="fu">fitTD</span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDHeat05</span>,</span></span>
<span class="r-in"><span>                design <span class="op">=</span> <span class="st">"ibd"</span>,</span></span>
<span class="r-in"><span>                traits <span class="op">=</span> <span class="st">"yield"</span>,</span></span>
<span class="r-in"><span>                what <span class="op">=</span> <span class="st">"fixed"</span>,</span></span>
<span class="r-in"><span>                engine <span class="op">=</span> <span class="st">"lme4"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Summarize results.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lmeMod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary statistics </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ==================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary statistics for yield in HEAT05  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             yield</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations      338.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of missing values      0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean                       184.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Median                     179.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Min                         54.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Max                        341.77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> First quantile             148.56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Third quantile             220.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance                 2569.229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predicted means (BLUEs) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ===============================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best 20 genotypes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        BLUEs     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB023 302.84 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB025 297.84 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB022 285.13 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB032 280.96 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB011 272.45 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB156 262.77 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB055 253.21 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB020 253.08 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB144 251.55 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB045 250.07 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB054 246.51 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB031 245.69 30.338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB027 244.27 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB128 243.91 30.338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB194 239.22 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB077 238.66 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB093 236.58 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB106 233.86 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB041 232.83 30.194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB143 232.41 30.194</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create base plots of the results.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lmeMod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitTD-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a pdf report summarizing results.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">lmeMod</span>,</span></span>
<span class="r-in"><span>       outfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".pdf"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       what <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in report.STA(lmeMod, outfile = tempfile(fileext = ".pdf"), what = "fixed"):</span> An installation of LaTeX is required to create a pdf report.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit model using SpATS.</span></span></span>
<span class="r-in"><span><span class="va">spaMod</span> <span class="op">&lt;-</span> <span class="fu">fitTD</span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDHeat05</span>,</span></span>
<span class="r-in"><span>                design <span class="op">=</span> <span class="st">"res.rowcol"</span>,</span></span>
<span class="r-in"><span>                traits <span class="op">=</span> <span class="st">"yield"</span>,</span></span>
<span class="r-in"><span>                what <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using SpATS for fitting models.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">spaMod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary statistics </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ==================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary statistics for yield in HEAT05  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             yield</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations      338.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of missing values      0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean                       184.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Median                     179.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Min                         54.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Max                        341.77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> First quantile             148.56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Third quantile             220.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance                 2569.229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predicted means (BLUEs) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ===============================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best 20 genotypes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        BLUEs     SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB023 285.02 11.120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB025 283.93 11.058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB022 281.90 11.149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB032 278.93 11.100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB011 271.10 11.300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB156 267.22 11.313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB144 265.80 11.391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB031 252.95 11.063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB093 247.71 11.249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB054 247.14 11.463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB055 247.04 11.414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB020 241.19 11.094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB028 239.22 11.212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB128 238.02 11.437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB194 237.85 11.260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB155 236.51 11.268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB143 236.26 11.454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB027 235.38 11.120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB163 234.34 11.146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SB181 233.11 11.083</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create spatial plots of the results.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spaMod</span>, plotType <span class="op">=</span> <span class="st">"spatial"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitTD-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit model using SpATS.</span></span></span>
<span class="r-in"><span><span class="co">## Specify the number of segments to use in PSANOVA</span></span></span>
<span class="r-in"><span><span class="va">spaMod2</span> <span class="op">&lt;-</span> <span class="fu">fitTD</span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDHeat05</span>,</span></span>
<span class="r-in"><span>                 design <span class="op">=</span> <span class="st">"res.rowcol"</span>,</span></span>
<span class="r-in"><span>                 traits <span class="op">=</span> <span class="st">"yield"</span>,</span></span>
<span class="r-in"><span>                 what <span class="op">=</span> <span class="st">"fixed"</span>,</span></span>
<span class="r-in"><span>                 control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nSeg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13</span>, <span class="fl">26</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using SpATS for fitting models.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create a pdf report summarizing results.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">spaMod</span>, outfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".pdf"</span><span class="op">)</span>, what <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in report.STA(spaMod, outfile = tempfile(fileext = ".pdf"), what = "fixed"):</span> An installation of LaTeX is required to create a pdf report.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit model using asreml.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">asrMod</span> <span class="op">&lt;-</span> <span class="fu">fitTD</span><span class="op">(</span>TD <span class="op">=</span> <span class="va">TDHeat05</span>,</span></span>
<span class="r-in"><span>                  design <span class="op">=</span> <span class="st">"res.rowcol"</span>,</span></span>
<span class="r-in"><span>                  traits <span class="op">=</span> <span class="st">"yield"</span>,</span></span>
<span class="r-in"><span>                  what <span class="op">=</span> <span class="st">"fixed"</span>,</span></span>
<span class="r-in"><span>                  engine <span class="op">=</span> <span class="st">"asreml"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">asrMod</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">asrMod</span>,</span></span>
<span class="r-in"><span>         outfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".pdf"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         what <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bart-Jan van Rossum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

